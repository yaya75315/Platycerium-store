{"ast":null,"code":"import _toConsumableArray from\"/Users/wangyazhi/Documents/\\u4F5C\\u54C1\\u96C6/Platycerium-store/online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/wangyazhi/Documents/\\u4F5C\\u54C1\\u96C6/Platycerium-store/online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/wangyazhi/Documents/\\u4F5C\\u54C1\\u96C6/Platycerium-store/online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/wangyazhi/Documents/\\u4F5C\\u54C1\\u96C6/Platycerium-store/online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/wangyazhi/Documents/\\u4F5C\\u54C1\\u96C6/Platycerium-store/online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"commons/axios\";import{TransitionGroup,CSSTransition}from\"react-transition-group\";import Layout from\"Layout\";import CartItem from\"component/CartItem\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var cart=/*#__PURE__*/function(_Component){_inherits(cart,_Component);var _super=_createSuper(cart);function cart(){var _this;_classCallCheck(this,cart);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={carts:[]};_this.totalPrice=function(){var totalPrice=_this.state.carts.map(function(_cart2){return _cart2.mount*parseInt(_cart2.price);}).reduce(function(a,value){return a+value;},0);return totalPrice;};_this.updateCart=function(_cart3){var newCarts=_toConsumableArray(_this.state.carts);//複製新的購物車\nvar _index=newCarts.findIndex(function(c){return c.id===_cart3.id;});newCarts.splice(_index,1,_cart3);_this.setState({carts:newCarts});};_this.deleteCart=function(_cart4){var _cart=_this.state.carts.filter(function(c){return c.id!==_cart4.id;});_this.setState({carts:_cart});};return _this;}_createClass(cart,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var user=global.auth.getUser()||{};axios.get(\"/carts?userId=\".concat(user.email)).then(function(res){return _this2.setState({carts:res.data});});}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/_jsx(Layout,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"cart-page\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"cart-title\",children:\"\\u8CFC\\u7269\\u8ECA\"}),/*#__PURE__*/_jsx(\"div\",{className:\"cart-list\",children:/*#__PURE__*/_jsx(TransitionGroup,{component:null,children:this.state.carts.map(function(_cart5){return/*#__PURE__*/_jsx(CSSTransition,{classNames:\"cart-item\",timeout:300,children:/*#__PURE__*/_jsx(CartItem,{cart:_cart5,updateCart:_this3.updateCart,deleteCart:_this3.deleteCart},_cart5.id)},_cart5.id);})})}),this.state.carts.length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"no-cart\",children:\"\\u9084\\u6C92\\u6709\\u5546\\u54C1\\uFF0C\\u8D95\\u5FEB\\u52A0\\u5165\\u8CFC\\u7269\\u8ECA\\u5427\\uFF01\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-total\",children:[\"\\u7E3D\\u984D: \",/*#__PURE__*/_jsxs(\"span\",{className:\"total-price\",children:[\"$\",this.totalPrice()]})]})]})});}}]);return cart;}(Component);export{cart as default};","map":{"version":3,"sources":["/Users/wangyazhi/Documents/作品集/Platycerium-store/online-store/src/pages/Cart.js"],"names":["React","Component","axios","TransitionGroup","CSSTransition","Layout","CartItem","cart","state","carts","totalPrice","map","mount","parseInt","price","reduce","a","value","updateCart","newCarts","_index","findIndex","c","id","splice","setState","deleteCart","_cart","filter","user","global","auth","getUser","get","email","then","res","data","length"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"commons/axios\";\nimport { TransitionGroup, CSSTransition } from \"react-transition-group\";\nimport Layout from \"Layout\";\nimport CartItem from \"component/CartItem\";\n\nexport default class cart extends Component {\n  state = {\n    carts: [],\n  };\n  componentDidMount() {\n    const user = global.auth.getUser() || {};\n    axios.get(`/carts?userId=${user.email}`).then((res) =>\n      this.setState({\n        carts: res.data,\n      })\n    );\n  }\n\n  totalPrice = () => {\n    const totalPrice = this.state.carts\n      .map((cart) => cart.mount * parseInt(cart.price))\n      .reduce((a, value) => a + value, 0);\n    return totalPrice;\n  };\n\n  updateCart = (cart) => {\n    const newCarts = [...this.state.carts]; //複製新的購物車\n    const _index = newCarts.findIndex((c) => c.id === cart.id);\n    newCarts.splice(_index, 1, cart);\n    this.setState({\n      carts: newCarts,\n    });\n  };\n\n  deleteCart = (cart) => {\n    const _cart = this.state.carts.filter((c) => c.id !== cart.id);\n    this.setState({\n      carts: _cart,\n    });\n  };\n\n  render() {\n    return (\n      <Layout>\n        <div className=\"cart-page\">\n          <span className=\"cart-title\">購物車</span>\n          <div className=\"cart-list\">\n            <TransitionGroup component={null}>\n              {this.state.carts.map((cart) => (\n                <CSSTransition\n                  classNames=\"cart-item\"\n                  timeout={300}\n                  key={cart.id}\n                >\n                  <CartItem\n                    key={cart.id}\n                    cart={cart}\n                    updateCart={this.updateCart}\n                    deleteCart={this.deleteCart}\n                  />\n                </CSSTransition>\n              ))}\n            </TransitionGroup>\n          </div>\n          {this.state.carts.length === 0 && (\n            <p className=\"no-cart\">還沒有商品，趕快加入購物車吧！</p>\n          )}\n          <div className=\"cart-total\">\n            總額: <span className=\"total-price\">${this.totalPrice()}</span>\n          </div>\n        </div>\n      </Layout>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}