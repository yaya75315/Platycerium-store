{"ast":null,"code":"import _objectSpread from\"/Users/wangyazhi/Documents/\\u4F5C\\u54C1\\u96C6/Platycerium-store/online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/wangyazhi/Documents/\\u4F5C\\u54C1\\u96C6/Platycerium-store/online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/wangyazhi/Documents/\\u4F5C\\u54C1\\u96C6/Platycerium-store/online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{useForm}from\"react-hook-form\";import axios from\"commons/axios\";import{toast}from\"react-toastify\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(props){var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,errors=_useForm.formState.errors;var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var email,password,res,jwToken,message;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;email=data.email,password=data.password;_context.next=4;return axios.post(\"/auth/login\",{email:email,password:password});case 4:res=_context.sent;jwToken=res.data;global.auth.setToken(jwToken);toast.success(\"登入成功\");props.history.push(\"/\");_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);message=_context.t0.response.data.message;toast.error(message);case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"login-wrapper\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"box login-box\",onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"\\u96FB\\u5B50\\u4FE1\\u7BB1\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"control\",children:[/*#__PURE__*/_jsx(\"input\",_objectSpread({className:\"input \".concat(errors.email&&\"is-danger\"),name:\"email\",type:\"text\",placeholder:\"email\"},register(\"email\",{required:\"需要填寫信箱\",pattern:{value:/^\\w+((-\\w+)|(\\.\\w+))*\\@[A-Za-z0-9]+((\\.|-)[A-Za-z0-9]+)*\\.[A-Za-z]+$/,message:\"格式錯誤\"}}))),errors.email&&/*#__PURE__*/_jsx(\"p\",{className:\"helper has-text-danger\",children:errors.email.message})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"\\u5BC6\\u78BC\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"control\",children:[/*#__PURE__*/_jsx(\"input\",_objectSpread({className:\"input \".concat(errors.password&&\"is-danger\"),name:\"password\",type:\"password\",placeholder:\"password\"},register(\"password\",{required:\"需要填寫密碼\",minLength:{value:6,message:\"密碼需要大於6位數\"}}))),errors.password&&/*#__PURE__*/_jsx(\"p\",{className:\"helper has-text-danger\",children:errors.password.message})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-fullwidth is-primary\",children:\"Login\"})})]})});};export default Login;","map":{"version":3,"sources":["/Users/wangyazhi/Documents/作品集/Platycerium-store/online-store/src/pages/Login.js"],"names":["useForm","axios","toast","Login","props","register","handleSubmit","errors","formState","onSubmit","data","email","password","post","res","jwToken","global","auth","setToken","success","history","push","message","response","error","required","pattern","value","minLength"],"mappings":"qkBAAA,OAASA,OAAT,KAAwB,iBAAxB,CACA,MAAOC,CAAAA,KAAP,KAAkB,eAAlB,CACA,OAASC,KAAT,KAAsB,gBAAtB,C,wFAEA,GAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAACC,KAAD,CAAW,cAKnBJ,OAAO,EALY,CAErBK,QAFqB,UAErBA,QAFqB,CAGrBC,YAHqB,UAGrBA,YAHqB,CAIRC,MAJQ,UAIrBC,SAJqB,CAIRD,MAJQ,CAOvB,GAAME,CAAAA,QAAQ,0FAAG,iBAAOC,IAAP,yKAELC,KAFK,CAEeD,IAFf,CAELC,KAFK,CAEEC,QAFF,CAEeF,IAFf,CAEEE,QAFF,uBAGKX,CAAAA,KAAK,CAACY,IAAN,CAAW,aAAX,CAA0B,CAAEF,KAAK,CAALA,KAAF,CAASC,QAAQ,CAARA,QAAT,CAA1B,CAHL,QAGPE,GAHO,eAIPC,OAJO,CAIGD,GAAG,CAACJ,IAJP,CAKbM,MAAM,CAACC,IAAP,CAAYC,QAAZ,CAAqBH,OAArB,EACAb,KAAK,CAACiB,OAAN,CAAc,MAAd,EACAf,KAAK,CAACgB,OAAN,CAAcC,IAAd,CAAmB,GAAnB,EAPa,iFASPC,OATO,CASG,YAAMC,QAAN,CAAeb,IAAf,CAAoBY,OATvB,CAUbpB,KAAK,CAACsB,KAAN,CAAYF,OAAZ,EAVa,qEAAH,kBAARb,CAAAA,QAAQ,4CAAd,CAcA,mBACE,YAAK,SAAS,CAAC,eAAf,uBACE,cAAM,SAAS,CAAC,eAAhB,CAAgC,QAAQ,CAAEH,YAAY,CAACG,QAAD,CAAtD,wBACE,aAAK,SAAS,CAAC,OAAf,wBACE,cAAO,SAAS,CAAC,OAAjB,sCADF,cAEE,aAAK,SAAS,CAAC,SAAf,wBACE,4BACE,SAAS,iBAAWF,MAAM,CAACI,KAAP,EAAgB,WAA3B,CADX,CAEE,IAAI,CAAC,OAFP,CAGE,IAAI,CAAC,MAHP,CAIE,WAAW,CAAC,OAJd,EAKMN,QAAQ,CAAC,OAAD,CAAU,CACpBoB,QAAQ,CAAE,QADU,CAEpBC,OAAO,CAAE,CACPC,KAAK,CACH,sEAFK,CAGPL,OAAO,CAAE,MAHF,CAFW,CAAV,CALd,EADF,CAeGf,MAAM,CAACI,KAAP,eACC,UAAG,SAAS,CAAC,wBAAb,UAAuCJ,MAAM,CAACI,KAAP,CAAaW,OAApD,EAhBJ,GAFF,GADF,cAuBE,aAAK,SAAS,CAAC,OAAf,wBACE,cAAO,SAAS,CAAC,OAAjB,0BADF,cAEE,aAAK,SAAS,CAAC,SAAf,wBACE,4BACE,SAAS,iBAAWf,MAAM,CAACK,QAAP,EAAmB,WAA9B,CADX,CAEE,IAAI,CAAC,UAFP,CAGE,IAAI,CAAC,UAHP,CAIE,WAAW,CAAC,UAJd,EAKMP,QAAQ,CAAC,UAAD,CAAa,CACvBoB,QAAQ,CAAE,QADa,CAEvBG,SAAS,CAAE,CACTD,KAAK,CAAE,CADE,CAETL,OAAO,CAAE,WAFA,CAFY,CAAb,CALd,EADF,CAcGf,MAAM,CAACK,QAAP,eACC,UAAG,SAAS,CAAC,wBAAb,UACGL,MAAM,CAACK,QAAP,CAAgBU,OADnB,EAfJ,GAFF,GAvBF,cA8CE,YAAK,SAAS,CAAC,SAAf,uBACE,eAAQ,SAAS,CAAC,gCAAlB,mBADF,EA9CF,GADF,EADF,CAsDD,CA3ED,CA6EA,cAAenB,CAAAA,KAAf","sourcesContent":["import { useForm } from \"react-hook-form\";\nimport axios from \"commons/axios\";\nimport { toast } from \"react-toastify\";\n\nconst Login = (props) => {\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n  } = useForm();\n\n  const onSubmit = async (data) => {\n    try {\n      const { email, password } = data;\n      const res = await axios.post(\"/auth/login\", { email, password });\n      const jwToken = res.data;\n      global.auth.setToken(jwToken);\n      toast.success(\"登入成功\");\n      props.history.push(\"/\");\n    } catch (error) {\n      const message = error.response.data.message;\n      toast.error(message);\n    }\n  };\n\n  return (\n    <div className=\"login-wrapper\">\n      <form className=\"box login-box\" onSubmit={handleSubmit(onSubmit)}>\n        <div className=\"field\">\n          <label className=\"label\">電子信箱</label>\n          <div className=\"control\">\n            <input\n              className={`input ${errors.email && \"is-danger\"}`}\n              name=\"email\"\n              type=\"text\"\n              placeholder=\"email\"\n              {...register(\"email\", {\n                required: \"需要填寫信箱\",\n                pattern: {\n                  value:\n                    /^\\w+((-\\w+)|(\\.\\w+))*\\@[A-Za-z0-9]+((\\.|-)[A-Za-z0-9]+)*\\.[A-Za-z]+$/,\n                  message: \"格式錯誤\",\n                },\n              })}\n            />\n            {errors.email && (\n              <p className=\"helper has-text-danger\">{errors.email.message}</p>\n            )}\n          </div>\n        </div>\n        <div className=\"field\">\n          <label className=\"label\">密碼</label>\n          <div className=\"control\">\n            <input\n              className={`input ${errors.password && \"is-danger\"}`}\n              name=\"password\"\n              type=\"password\"\n              placeholder=\"password\"\n              {...register(\"password\", {\n                required: \"需要填寫密碼\",\n                minLength: {\n                  value: 6,\n                  message: \"密碼需要大於6位數\",\n                },\n              })}\n            />\n            {errors.password && (\n              <p className=\"helper has-text-danger\">\n                {errors.password.message}\n              </p>\n            )}\n          </div>\n        </div>\n        <div className=\"control\">\n          <button className=\"button is-fullwidth is-primary\">Login</button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}