{"ast":null,"code":"import _objectSpread from\"/Users/wangyazhi/Documents/\\u4F5C\\u54C1\\u96C6/Platycerium-store/online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/wangyazhi/Documents/\\u4F5C\\u54C1\\u96C6/Platycerium-store/online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/wangyazhi/Documents/\\u4F5C\\u54C1\\u96C6/Platycerium-store/online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{useForm}from\"react-hook-form\";import axios from\"commons/axios\";import{toast}from\"react-toastify\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Register=function Register(props){var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,errors=_useForm.formState.errors;var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var nickname,email,password,res,jwToken,message;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(data);_context.prev=1;nickname=data.nickname,email=data.email,password=data.password;_context.next=5;return axios.post(\"/auth/register\",{nickname:nickname,email:email,password:password,type:0});case 5:res=_context.sent;jwToken=res.data;global.auth.setToken(jwToken);console.log(jwToken);toast.success(\"註冊成功\");props.history.push(\"/\");_context.next=17;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](1);message=_context.t0.response.data.message;toast.error(message);case 17:case\"end\":return _context.stop();}}},_callee,null,[[1,13]]);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"login-wrapper\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"box login-box\",onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"\\u66B1\\u7A31\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"control\",children:[/*#__PURE__*/_jsx(\"input\",_objectSpread({className:\"input \".concat(errors.nickname&&\"is-danger\"),name:\"nickname\",type:\"text\",placeholder:\"nickname\"},register(\"nickname\",{required:\"需要填寫暱稱\"}))),errors.nickname&&/*#__PURE__*/_jsx(\"p\",{className:\"helper has-text-danger\",children:errors.nickname.message})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"\\u96FB\\u5B50\\u4FE1\\u7BB1\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"control\",children:[/*#__PURE__*/_jsx(\"input\",_objectSpread({className:\"input \".concat(errors.email&&\"is-danger\"),name:\"email\",type:\"text\",placeholder:\"email\"},register(\"email\",{required:\"需要填寫信箱\",pattern:{value:/^\\w+((-\\w+)|(\\.\\w+))*\\@[A-Za-z0-9]+((\\.|-)[A-Za-z0-9]+)*\\.[A-Za-z]+$/,message:\"格式錯誤\"}}))),errors.email&&/*#__PURE__*/_jsx(\"p\",{className:\"helper has-text-danger\",children:errors.email.message})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"\\u5BC6\\u78BC\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"control\",children:[/*#__PURE__*/_jsx(\"input\",_objectSpread({className:\"input \".concat(errors.password&&\"is-danger\"),name:\"password\",type:\"password\",placeholder:\"password\"},register(\"password\",{required:\"需要填寫密碼\",minLength:{value:6,message:\"密碼需要大於6位數\"}}))),errors.password&&/*#__PURE__*/_jsx(\"p\",{className:\"helper has-text-danger\",children:errors.password.message})]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"control\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button is-fullwidth is-primary\",children:\"\\u78BA\\u8A8D\"})})]})});};export default Register;","map":{"version":3,"sources":["/Users/wangyazhi/Documents/作品集/Platycerium-store/online-store/src/pages/Register.js"],"names":["useForm","axios","toast","Register","props","register","handleSubmit","errors","formState","onSubmit","data","console","log","nickname","email","password","post","type","res","jwToken","global","auth","setToken","success","history","push","message","response","error","required","pattern","value","minLength"],"mappings":"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","sourcesContent":["import { useForm } from \"react-hook-form\";\nimport axios from \"commons/axios\";\nimport { toast } from \"react-toastify\";\n\nconst Register = (props) => {\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n  } = useForm();\n\n  const onSubmit = async (data) => {\n    console.log(data);\n\n    try {\n      const { nickname, email, password } = data;\n      const res = await axios.post(\"/auth/register\", {\n        nickname,\n        email,\n        password,\n        type: 0,\n      });\n      const jwToken = res.data;\n      global.auth.setToken(jwToken);\n      console.log(jwToken);\n      toast.success(\"註冊成功\");\n      props.history.push(\"/\");\n    } catch (error) {\n      const message = error.response.data.message;\n      toast.error(message);\n    }\n  };\n\n  return (\n    <div className=\"login-wrapper\">\n      <form className=\"box login-box\" onSubmit={handleSubmit(onSubmit)}>\n        <div className=\"field\">\n          <label className=\"label\">暱稱</label>\n          <div className=\"control\">\n            <input\n              className={`input ${errors.nickname && \"is-danger\"}`}\n              name=\"nickname\"\n              type=\"text\"\n              placeholder=\"nickname\"\n              {...register(\"nickname\", {\n                required: \"需要填寫暱稱\",\n              })}\n            />\n            {errors.nickname && (\n              <p className=\"helper has-text-danger\">\n                {errors.nickname.message}\n              </p>\n            )}\n          </div>\n        </div>\n        <div className=\"field\">\n          <label className=\"label\">電子信箱</label>\n          <div className=\"control\">\n            <input\n              className={`input ${errors.email && \"is-danger\"}`}\n              name=\"email\"\n              type=\"text\"\n              placeholder=\"email\"\n              {...register(\"email\", {\n                required: \"需要填寫信箱\",\n                pattern: {\n                  value:\n                    /^\\w+((-\\w+)|(\\.\\w+))*\\@[A-Za-z0-9]+((\\.|-)[A-Za-z0-9]+)*\\.[A-Za-z]+$/,\n                  message: \"格式錯誤\",\n                },\n              })}\n            />\n            {errors.email && (\n              <p className=\"helper has-text-danger\">{errors.email.message}</p>\n            )}\n          </div>\n        </div>\n        <div className=\"field\">\n          <label className=\"label\">密碼</label>\n          <div className=\"control\">\n            <input\n              className={`input ${errors.password && \"is-danger\"}`}\n              name=\"password\"\n              type=\"password\"\n              placeholder=\"password\"\n              {...register(\"password\", {\n                required: \"需要填寫密碼\",\n                minLength: {\n                  value: 6,\n                  message: \"密碼需要大於6位數\",\n                },\n              })}\n            />\n            {errors.password && (\n              <p className=\"helper has-text-danger\">\n                {errors.password.message}\n              </p>\n            )}\n          </div>\n        </div>\n        <br />\n        <div className=\"control\">\n          <button className=\"button is-fullwidth is-primary\">確認</button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default Register;\n"]},"metadata":{},"sourceType":"module"}